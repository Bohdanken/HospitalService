<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hospitalier</title>
  <link rel="stylesheet" type="text/css" media="all" href="../../css/style1.css" th:href="@{/css/style1.css}"/>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;700&display=swap" rel="stylesheet" />
</head>
<body>
<div class="app-title-background">
  <span class="app-title">Hospitalier</span>
</div>

<div class="login-field">
  <div class="login-background">
    <div class="login-title">
      <span>Форма запису на прийом до лікаря</span>
    </div>
    <div>
      <p>Емейл: <span th:text="${patientEmail}"></span></p>
      <p>Ім'я: <span th:text="${patientName}"></span></p>
    </div>
    <div class="login-form">

<!--      <form th:action="@{/malp}" th:object="${appointment}" method="post">-->
<!--        <div>-->
<!--          <label for="hospital">Виберіть лікарню:</label>-->
<!--          <select id="hospital" >-->
<!--            <option value="">&#45;&#45; Виберіть лікарню &#45;&#45;</option>-->
<!--            <option th:each="hospital : ${hospitals}"-->
<!--                    th:value="${hospital.id}"-->
<!--                    th:text="${hospital.name}">Лікарня</option>-->
<!--          </select>-->
<!--        </div>-->
<!--        <div>-->
<!--          <label for="doctorType">Виберіть тип лікаря:</label>-->
<!--          <select id="doctorType">-->
<!--            <option value="">&#45;&#45; Виберіть тип лікаря &#45;&#45;</option>-->
<!--            <option th:each="type : ${doctorTypes}"-->
<!--                    th:text="${type}">Тип лікаря</option>-->
<!--          </select>-->
<!--        </div>-->
<!--        <div>-->
<!--          <label for="date">Дата візиту:</label>-->
<!--          <input type="date" id="date" >-->
<!--        </div>-->
<!--        <div>-->
<!--          <label for="time">Час візиту:</label>-->
<!--          <input type="time" id="time" >-->
<!--        </div>-->

<!--        <div>-->
<!--          <button type="submit">Записатися</button>-->
<!--        </div>-->
<!--      </form>-->

      <div>
        <table>
          <thead>
          <tr>
            <th>Номер пацієнта</th>
            <th>Номер лікаря</th>
            <th>Тип лікаря</th>
            <th>Дата візиту</th>
            <th>Дії</th>
          </tr>
          </thead>
          <tbody>
          <tr th:each="visit : ${visits}">
            <td th:text="${visit.patientId}"></td>
            <td th:text="${visit.doctorId}"></td>
            <td th:text="${visit.doctorType}"></td>
            <td th:text="${visit.dateOfVisit}"></td>
            <td>
              <button type="button" class="delete-btn" data-id="${visit.id}">Видалити</button>
            </td>
          </tr>
          </tbody>
        </table>
      </div>

      <div>
        <button>Візити</button>
      </div>
    </div>
  </div>
</div>
<span class="square square-tl"></span>
<span class="square square-tr"></span>
<span class="square square-bl"></span>
<span class="square square-br"></span>
<span class="star star1"></span>
<span class="star star2"></span>
</body>
<script>
  document.querySelectorAll('.delete-btn').forEach(button => {
    button.addEventListener('click', function() {
      const visitId = this.getAttribute('data-id');
      if (confirm('Ви впевнені, що хочете видалити цей візит?')) {
        fetch(`/api/visit/${visitId}`, {
          method: 'DELETE'
        }).then(response => {
          if(response.ok) {
            window.location.reload();
          } else {
            alert('Помилка при видаленні візиту');
          }
        }).catch(error => {
          console.error('Помилка:', error);
        });
      }
    });
  });
</script>

</html>